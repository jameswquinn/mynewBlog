<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Begin Jekyll SEO tag v2.1.0 -->
<meta property="og:title" content="Publishing via the API" />
<meta name="description" content="For the last week publishing in the Siteleaf interface has been powered by our API. This has been a requested feature by some of our users and ourselves. Its behavior is bit different than some of our other API endpoints, so let’s go over it. To initiate a publish, make an authenticated POST request to the /sites/:id/publish endpoint. $ curl -u &quot;$API_KEY:$API_SECRET&quot; -X POST \ http://api.siteleaf.com/v1/sites/$SITE_ID/publish {&quot;job_id&quot;:&quot;e79af12c79ccd8866902d3dd&quot;} This triggers a publish and immediately returns a job ID (or returns an already running job ID if one exists). You can stop here if you’d like and Siteleaf will happily chug away in the background. But the fun doesn’t stop there. You can optionally check in on publish progress using your job_id from above by making an authenticated GET request to the new /jobs/:id endpoint." />
<meta property="og:description" content="For the last week publishing in the Siteleaf interface has been powered by our API. This has been a requested feature by some of our users and ourselves. Its behavior is bit different than some of our other API endpoints, so let’s go over it. To initiate a publish, make an authenticated POST request to the /sites/:id/publish endpoint. $ curl -u &quot;$API_KEY:$API_SECRET&quot; -X POST \ http://api.siteleaf.com/v1/sites/$SITE_ID/publish {&quot;job_id&quot;:&quot;e79af12c79ccd8866902d3dd&quot;} This triggers a publish and immediately returns a job ID (or returns an already running job ID if one exists). You can stop here if you’d like and Siteleaf will happily chug away in the background. But the fun doesn’t stop there. You can optionally check in on publish progress using your job_id from above by making an authenticated GET request to the new /jobs/:id endpoint." />
<link rel="canonical" href="http://localhost:4000/myBlog/blog/publishing-via-the-api/" />
<meta property="og:url" content="http://localhost:4000/myBlog/blog/publishing-via-the-api/" />
<meta property="og:site_name" content="Siteleaf" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2015-06-24T11:10:00-04:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quinn" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "Publishing via the API",
"datePublished": "2015-06-24T11:10:00-04:00",
"description": "For the last week publishing in the Siteleaf interface has been powered by our API. This has been a requested feature by some of our users and ourselves. Its behavior is bit different than some of our other API endpoints, so let’s go over it. To initiate a publish, make an authenticated POST request to the /sites/:id/publish endpoint. $ curl -u &quot;$API_KEY:$API_SECRET&quot; -X POST \\ http://api.siteleaf.com/v1/sites/$SITE_ID/publish {&quot;job_id&quot;:&quot;e79af12c79ccd8866902d3dd&quot;} This triggers a publish and immediately returns a job ID (or returns an already running job ID if one exists). You can stop here if you’d like and Siteleaf will happily chug away in the background. But the fun doesn’t stop there. You can optionally check in on publish progress using your job_id from above by making an authenticated GET request to the new /jobs/:id endpoint.",
"publisher": {"@type": "Organization",
"logo": {"@type": "ImageObject",
"url": "http://localhost:4000/myBlog/assets/logo.svg"}},
"url": "http://localhost:4000/myBlog/blog/publishing-via-the-api/"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="twitter:image" content="http://localhost:4000/assets/avatar.png"/>
    <title>Publishing via the API - Siteleaf</title>
    <link rel="stylesheet" href="/myBlog/styles/milligram.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.2.4/milligram.min.css" />
    -->
    <link rel="icon" type="image/x-icon" href="/myBlog/assets/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Siteleaf: Blog (RSS)" href="http://localhost:4000/myBlogfeed.xml" />
  </head>
  <body class="post">
    
      <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-1666437-33', 'auto');
        ga('send', 'pageview');
      </script>
    
    <div class="container">
      
  <!-- blog permalink, inherit from first tag -->
  
  

<div class="headerWrap bg--lightest-gray">
  <header class="header">
    <ul class="header__items">
      
      <li class="header__item">
        <a href="/myBlog/blog/" class="header__link">Blog</a>
      </li>
      
      <li class="header__item">
        <a href="/myBlog/gallery/" class="header__link">Gallery</a>
      </li>
      
      <li class="header__item">
        <a href="/myBlog/plans/" class="header__link">Plans</a>
      </li>
      
    </ul>
    <a href="/myBlog/" class="header__home"><img src="/myBlog/assets/logo.svg" class="header__logo" alt="Siteleaf" /></a>
    <h1 class="header__title">Publishing via the API</h1>
    
    
  </header>
</div>

        
      

<article class="article">
  
  
  <section class="article__meta">
    
      <ul class="article__tags">
        
          
          
            
            
              <li class="article__tag"><a href="/myBlog/blog/tags/announcement/" class="article__tag__link">Announcement</a></li>
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
        
          
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
              <li class="article__tag"><a href="/myBlog/blog/tags/tutorial/" class="article__tag__link">Tutorial</a></li>
            
          
            
            
          
            
            
          
        
          
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
              <li class="article__tag"><a href="/myBlog/blog/tags/v1/" class="article__tag__link">v1</a></li>
            
          
            
            
          
        
      </ul>
    
    
    <time class="article__date" datetime="2015-06-24T11:10:00-04:00">Jun 24, 2015</time>
    
  </section>
  
  <section class="article__content">
    
      <p class="note">This post refers to a legacy version of Siteleaf.</p>
    

    

    
      <p>For the last week publishing in the Siteleaf interface has been powered by our API. This has been a requested feature by some of our users and ourselves. Its behavior is bit different than some of our other API endpoints, so let’s go over it.</p>

<p>To initiate a publish, make an authenticated <code class="highlighter-rouge">POST</code> request to the <code class="highlighter-rouge">/sites/:id/publish</code> endpoint.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>curl -u <span class="s2">"</span><span class="nv">$API_KEY</span><span class="s2">:</span><span class="nv">$API_SECRET</span><span class="s2">"</span> -X POST <span class="se">\</span>
  http://api.siteleaf.com/v1/sites/<span class="nv">$SITE_ID</span>/publish

<span class="o">{</span><span class="s2">"job_id"</span>:<span class="s2">"e79af12c79ccd8866902d3dd"</span><span class="o">}</span> 
</code></pre>
</div>

<p>This triggers a publish and immediately returns a job ID (or returns an already running job ID if one exists). You can stop here if you’d like and Siteleaf will happily chug away in the background.</p>

<p>But the fun doesn’t stop there. You can optionally check in on publish progress using your <code class="highlighter-rouge">job_id</code> from above by making an authenticated <code class="highlighter-rouge">GET</code> request to the new <code class="highlighter-rouge">/jobs/:id</code> endpoint.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>curl -u <span class="s2">"</span><span class="nv">$API_KEY</span><span class="s2">:</span><span class="nv">$API_SECRET</span><span class="s2">"</span> <span class="se">\</span>
  http://api.siteleaf.com/api/v1/jobs/e79af12c79ccd8866902d3dd

event:publish
data:<span class="o">{</span><span class="s2">"status"</span>:<span class="s2">"working"</span>,<span class="s2">"message"</span>:<span class="s2">"Checking... /home"</span>,<span class="s2">"updated_at"</span>:<span class="s2">"1435159120"</span><span class="o">}</span>

<span class="o">[</span>etc…]

event:publish
data:<span class="o">{</span><span class="s2">"status"</span>:<span class="s2">"complete"</span>,<span class="s2">"message"</span>:<span class="s2">"Published"</span>,<span class="s2">"updated_at"</span>:<span class="s2">"1435159121"</span><span class="o">}</span>
</code></pre>
</div>

<p>This endpoint, unlike our others, consistently returns <a href="https://en.wikipedia.org/wiki/Server-sent_events">Server Sent Events</a> (SSE) instead of JSON documents (including  errors). The <code class="highlighter-rouge">data</code> field is JSON encoded however. SSE is supported in all modern browsers and there are client libraries in a number of programming languages.</p>

<p>Additionally, job ID’s are kept for at least 30 minutes after completion so you can check in on a publish immediately or wait a bit.</p>

<p>Can’t wait to see what uses you come up with!</p>

<h3 id="publishing-from-the-gem">Publishing from the gem</h3>

<p>First install the latest gem (<a href="https://rubygems.org/gems/siteleaf"><code class="highlighter-rouge">0.9.23</code></a> as of writing)</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>gem install siteleaf
</code></pre>
</div>

<p>And then…</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>siteleaf publish
Fetching inventory...
Compiling...
<span class="o">[</span>etc…]
Published
<span class="gp">=&gt; </span>Publish completed.
</code></pre>
</div>

<p>Or if you don’t care about progress, you can use either of the following:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>siteleaf publish -q
<span class="gp">$ </span>siteleaf publish --quiet

<span class="gp">=&gt; </span>Publish queued.
</code></pre>
</div>

<p>🎉🎉</p>

    
    
  </section>
</article>



    </div>
    <h1>footer</h1>

  </body>
</html>
